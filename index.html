<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Personal Cloud</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- All CSS is embedded here -->
    <style>
        :root {
            --primary-color: #6a5af9;
            --secondary-color: #f2f2f7;
            --background-color: #ffffff;
            --text-color: #1c1c1e;
            --card-bg: #ffffff;
            --border-color: #e5e5ea;
            --shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            --font-family: 'Poppins', sans-serif;
        }

        /* Basic Setup */
        body {
            font-family: var(--font-family);
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Page Navigation Simulation */
        .page {
            display: none; /* Hide all pages by default */
        }
        .page.active {
            display: block; /* Show only the active page */
        }

        /* Navbar */
        .navbar {
            background-color: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        .navbar .container { display: flex; justify-content: space-between; align-items: center; }
        .nav-brand { font-size: 1.5rem; font-weight: 700; color: var(--primary-color); text-decoration: none; }
        .nav-links a { color: var(--text-color); text-decoration: none; margin-left: 1.5rem; font-weight: 600; cursor: pointer; transition: color 0.3s ease; }
        .nav-links a:hover { color: var(--primary-color); }

        /* Buttons */
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; }
        .btn-primary { background-color: var(--primary-color); color: #fff; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(106, 90, 249, 0.4); }

        /* Landing Page Hero */
        .hero-section { display: flex; align-items: center; justify-content: center; min-height: 80vh; background-color: var(--secondary-color); text-align: center; }
        .hero-section h1 { font-size: 3rem; font-weight: 700; margin-bottom: 1rem; }
        .hero-section p { font-size: 1.2rem; color: #666; margin-bottom: 2rem; }

        /* Auth Forms */
        .auth-container { display: flex; justify-content: center; padding: 4rem 0; }
        .form-container { background: var(--card-bg); padding: 2rem; border-radius: 12px; box-shadow: var(--shadow); width: 100%; max-width: 400px; }
        .form-container h2 { text-align: center; margin-bottom: 1.5rem; color: var(--primary-color); }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
        .form-group input { width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; box-sizing: border-box; }
        .form-toggle { text-align: center; margin-top: 1rem; }
        .form-toggle a { color: var(--primary-color); font-weight: 600; cursor: pointer; }
        #register-form { display: none; }
        
        /* Alerts */
        .alert { padding: 1rem; margin-bottom: 1rem; border-radius: 8px; text-align: center; font-weight: 600; }
        .alert-success { background-color: #d1e7dd; color: #0f5132; }
        .alert-error { background-color: #f8d7da; color: #842029; }
        #alert-box { display: none; }

        /* Dashboard */
        .dashboard-header { display: flex; justify-content: space-between; align-items: center; padding: 2rem 0; border-bottom: 1px solid var(--border-color); margin-bottom: 2rem; }
        .dashboard-header h1 { margin: 0; }
        .profile-pic img { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; }
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem; }
        .dashboard-card { background: var(--card-bg); padding: 1.5rem; border-radius: 12px; box-shadow: var(--shadow); }
        .dashboard-card h2 { margin-top: 0; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; }

        /* Notes Section */
        .note-form textarea { width: calc(100% - 1rem); min-height: 80px; border: 1px solid var(--border-color); border-radius: 8px; padding: 0.5rem; margin-bottom: 1rem; resize: vertical; }
        .note-form .btn { float: right; }
        .notes-list { margin-top: 4rem; max-height: 400px; overflow-y: auto; clear: both; }
        .note-item { background: var(--secondary-color); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; display: flex; justify-content: space-between; align-items: center; }
        .note-item p { margin: 0; word-break: break-word; }
        .delete-btn { color: #e53e3e; text-decoration: none; font-weight: 600; cursor: pointer; }

        /* Media Section */
        .upload-form { margin-bottom: 1.5rem; }
        .media-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 1rem; max-height: 450px; overflow-y: auto; }
        .media-item { text-align: center; }
        .media-item img, .media-item video { width: 100%; height: 120px; object-fit: cover; border-radius: 8px; border: 1px solid var(--border-color); }
        .media-item .doc-icon { width: 100%; height: 120px; display: flex; flex-direction: column; align-items: center; justify-content: center; background: var(--secondary-color); border-radius: 8px; }
        .doc-icon span { font-size: 2.5rem; }
        .doc-icon p, .media-title { font-size: 0.8rem; margin: 0.5rem 0 0 0; padding: 0 5px; word-break: break-all; }
    </style>
</head>
<body>

    <!-- Main Navigation Bar -->
    <nav class="navbar">
        <div class="container">
            <a href="#" class="nav-brand" id="nav-brand-link">MyCloudSpace</a>
            <div class="nav-links">
                <a id="nav-dashboard-link" style="display: none;">Dashboard</a>
                <a id="nav-login-link">Login / Register</a>
                <a id="nav-logout-link" style="display: none;">Logout</a>
            </div>
        </div>
    </nav>

    <main class="main-content">

        <!-- PAGE 1: Landing Page -->
        <div id="landing-page" class="page active">
            <div class="hero-section">
                <div class="container">
                    <h1>Your Personal Cloud, Reimagined.</h1>
                    <p>Manage your daily notes and media files securely in your browser.</p>
                    <a href="#" id="get-started-btn" class="btn btn-primary">Get Started</a>
                </div>
            </div>
        </div>

        <!-- PAGE 2: Login / Register Page -->
        <div id="auth-page" class="page">
            <div class="auth-container">
                <div class="form-container">
                    <div id="alert-box" class="alert"></div>
                    <!-- Login Form -->
                    <form id="login-form">
                        <h2>Login</h2>
                        <div class="form-group">
                            <label for="login-username">Username</label>
                            <input type="text" id="login-username" required>
                        </div>
                        <div class="form-group">
                            <label for="login-password">Password</label>
                            <input type="password" id="login-password" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Login</button>
                        <p class="form-toggle">Don't have an account? <a href="#" id="show-register-link">Register here</a></p>
                    </form>
                    <!-- Register Form -->
                    <form id="register-form">
                        <h2>Register</h2>
                        <div class="form-group">
                            <label for="register-username">Username</label>
                            <input type="text" id="register-username" required>
                        </div>
                        <div class="form-group">
                            <label for="register-password">Password</label>
                            <input type="password" id="register-password" required>
                        </div>
                        <div class="form-group">
                            <label for="profile-picture">Profile Picture</label>
                            <input type="file" id="profile-picture" accept="image/*">
                        </div>
                        <button type="submit" class="btn btn-primary">Register</button>
                        <p class="form-toggle">Already have an account? <a href="#" id="show-login-link">Login here</a></p>
                    </form>
                </div>
            </div>
        </div>

        <!-- PAGE 3: Dashboard Page -->
        <div id="dashboard-page" class="page">
            <div class="container dashboard-container">
                <header class="dashboard-header">
                    <h1 id="welcome-message">Welcome back!</h1>
                    <div class="profile-pic">
                        <img id="dashboard-profile-pic" src="" alt="Profile Picture">
                    </div>
                </header>
                <div class="dashboard-grid">
                    <!-- Notes Section -->
                    <div class="dashboard-card" id="notes-section">
                        <h2>My Notes</h2>
                        <form id="note-form" class="note-form">
                            <textarea id="note-content" placeholder="Write a new note..." required></textarea>
                            <button type="submit" class="btn">Add Note</button>
                        </form>
                        <div id="notes-list" class="notes-list">
                            <!-- Notes will be dynamically inserted here -->
                        </div>
                    </div>
                    <!-- Media Section -->
                    <div class="dashboard-card" id="media-section">
                        <h2>My Media</h2>
                        <form id="upload-form" class="upload-form">
                            <input type="file" id="file-input" required>
                            <button type="submit" class="btn">Upload</button>
                        </form>
                        <div id="media-grid" class="media-grid">
                            <!-- Media will be dynamically inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- All JavaScript is embedded here -->
    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DOM Elements ---
        const pages = document.querySelectorAll('.page');
        const nav = {
            brand: document.getElementById('nav-brand-link'),
            dashboard: document.getElementById('nav-dashboard-link'),
            login: document.getElementById('nav-login-link'),
            logout: document.getElementById('nav-logout-link')
        };
        const alertBox = document.getElementById('alert-box');

        // --- State Management (using localStorage) ---
        // WARNING: This is a simulation. Storing sensitive data like passwords
        // in localStorage is NOT secure for a real-world application.
        const db = {
            // Get data from localStorage or initialize if it doesn't exist
            getUsers: () => JSON.parse(localStorage.getItem('myCloudUsers')) || {},
            saveUsers: (users) => localStorage.setItem('myCloudUsers', JSON.stringify(users)),
            getNotes: () => JSON.parse(localStorage.getItem('myCloudNotes')) || {},
            saveNotes: (notes) => localStorage.setItem('myCloudNotes', JSON.stringify(notes)),
            getFiles: () => JSON.parse(localStorage.getItem('myCloudFiles')) || {},
            saveFiles: (files) => localStorage.setItem('myCloudFiles', JSON.stringify(files)),
            getCurrentUser: () => localStorage.getItem('myCloudCurrentUser'),
            setCurrentUser: (username) => localStorage.setItem('myCloudCurrentUser', username),
            clearCurrentUser: () => localStorage.removeItem('myCloudCurrentUser')
        };
        
        let currentUser = db.getCurrentUser();

        // --- Page Navigation Logic ---
        const showPage = (pageId) => {
            pages.forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            updateNav();
        };

        const updateNav = () => {
            if (db.getCurrentUser()) {
                nav.dashboard.style.display = 'inline';
                nav.logout.style.display = 'inline';
                nav.login.style.display = 'none';
            } else {
                nav.dashboard.style.display = 'none';
                nav.logout.style.display = 'none';
                nav.login.style.display = 'inline';
            }
        };

        // --- Alert Logic ---
        const showAlert = (message, type = 'error') => {
            alertBox.textContent = message;
            alertBox.className = `alert alert-${type}`;
            alertBox.style.display = 'block';
            setTimeout(() => { alertBox.style.display = 'none'; }, 3000);
        };
        
        // --- Authentication Logic ---
        const handleRegister = (e) => {
            e.preventDefault();
            const username = document.getElementById('register-username').value.trim();
            const password = document.getElementById('register-password').value;
            const profilePicFile = document.getElementById('profile-picture').files[0];

            if (!username || !password) {
                showAlert('Username and password are required.');
                return;
            }

            const users = db.getUsers();
            if (users[username]) {
                showAlert('Username already exists.');
                return;
            }
            
            // Handle profile picture
            const reader = new FileReader();
            reader.onload = (event) => {
                users[username] = { 
                    password: password, // In a real app, this should be hashed!
                    profilePicDataUrl: event.target.result 
                };
                db.saveUsers(users);
                showAlert('Registration successful! Please log in.', 'success');
                showLoginForm();
                document.getElementById('register-form').reset();
            };
            
            if (profilePicFile) {
                reader.readAsDataURL(profilePicFile);
            } else {
                // Use a default image if none is provided
                const defaultPic = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iIzYxNjE2MSI+PHBhdGggZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyczQuNDggMTAgMTAgMTAgMTAtNC40OCAxMC0xMFMxNy41MiAyIDEyIDJ6bTAgM2MxLjY2IDAgMyAxLjM0IDMgM3MtMS4zNCAzLTMgMy0zLTEuMzQtMy0zIDEuMzQtMyAzLTN6bTAgMTRjLTIuNzEgMC01LjgwLTEuMjgtNy43NS0zLjI1LjgxLTEuMjcgMi40OC0yIDQuMjUtMiAxLjc3IDAgMy40NCAuNzMgNC4yNSAyQzE3LjgwIDE3LjcyIDE0LjcxIDE5IDEyIDE5eiIvPjwvc3ZnPg==';
                users[username] = { password: password, profilePicDataUrl: defaultPic };
                db.saveUsers(users);
                showAlert('Registration successful! Please log in.', 'success');
                showLoginForm();
                document.getElementById('register-form').reset();
            }
        };

        const handleLogin = (e) => {
            e.preventDefault();
            const username = document.getElementById('login-username').value.trim();
            const password = document.getElementById('login-password').value;
            const users = db.getUsers();

            if (users[username] && users[username].password === password) {
                db.setCurrentUser(username);
                currentUser = username;
                showPage('dashboard-page');
                renderDashboard();
            } else {
                showAlert('Invalid username or password.');
            }
        };

        const handleLogout = () => {
            db.clearCurrentUser();
            currentUser = null;
            showPage('landing-page');
        };

        const showRegisterForm = () => {
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('register-form').style.display = 'block';
            alertBox.style.display = 'none';
        };

        const showLoginForm = () => {
            document.getElementById('login-form').style.display = 'block';
            document.getElementById('register-form').style.display = 'none';
        };

        // --- Dashboard Logic ---
        const renderDashboard = () => {
            if (!currentUser) return;
            
            const users = db.getUsers();
            document.getElementById('welcome-message').textContent = `Welcome back, ${currentUser}!`;
            document.getElementById('dashboard-profile-pic').src = users[currentUser].profilePicDataUrl;

            renderNotes();
            renderFiles();
        };

        const renderNotes = () => {
            const notesContainer = document.getElementById('notes-list');
            notesContainer.innerHTML = '';
            const allNotes = db.getNotes();
            const userNotes = allNotes[currentUser] || [];

            if (userNotes.length === 0) {
                notesContainer.innerHTML = '<p>You have no notes yet.</p>';
                return;
            }

            userNotes.slice().reverse().forEach(note => {
                const noteEl = document.createElement('div');
                noteEl.className = 'note-item';
                noteEl.innerHTML = `
                    <p>${note.content}</p>
                    <a class="delete-btn" data-id="${note.id}">Delete</a>
                `;
                notesContainer.appendChild(noteEl);
            });
        };

        const renderFiles = () => {
            const mediaContainer = document.getElementById('media-grid');
            mediaContainer.innerHTML = '';
            const allFiles = db.getFiles();
            const userFiles = allFiles[currentUser] || [];

            if (userFiles.length === 0) {
                mediaContainer.innerHTML = '<p>You have no media files yet.</p>';
                return;
            }
            
            userFiles.slice().reverse().forEach(file => {
                const fileEl = document.createElement('div');
                fileEl.className = 'media-item';
                let content = '';

                if (file.type.startsWith('image/')) {
                    content = `<img src="${file.dataUrl}" alt="${file.name}">`;
                } else if (file.type.startsWith('video/')) {
                    content = `<video controls><source src="${file.dataUrl}" type="${file.type}"></video>`;
                } else {
                    content = `<div class="doc-icon"><span>📄</span><p>${file.name}</p></div>`;
                }
                fileEl.innerHTML = `${content}<p class="media-title">${file.name}</p>`;
                mediaContainer.appendChild(fileEl);
            });
        };

        const handleAddNote = (e) => {
            e.preventDefault();
            const content = document.getElementById('note-content').value.trim();
            if (!content) return;

            const allNotes = db.getNotes();
            if (!allNotes[currentUser]) allNotes[currentUser] = [];
            
            allNotes[currentUser].push({ id: Date.now(), content: content });
            db.saveNotes(allNotes);
            renderNotes();
            document.getElementById('note-form').reset();
        };

        const handleDeleteNote = (e) => {
            if (e.target.classList.contains('delete-btn')) {
                const noteId = Number(e.target.dataset.id);
                const allNotes = db.getNotes();
                allNotes[currentUser] = allNotes[currentUser].filter(note => note.id !== noteId);
                db.saveNotes(allNotes);
                renderNotes();
            }
        };

        const handleAddFile = (e) => {
            e.preventDefault();
            const file = document.getElementById('file-input').files[0];
            if (!file) return;

            // Warning for large files as localStorage has limits (usually 5-10MB)
            if (file.size > 5 * 1024 * 1024) { // 5MB limit
                alert("Warning: File is larger than 5MB. It may not save correctly due to browser storage limits.");
            }

            const reader = new FileReader();
            reader.onload = (event) => {
                const allFiles = db.getFiles();
                if (!allFiles[currentUser]) allFiles[currentUser] = [];

                allFiles[currentUser].push({
                    id: Date.now(),
                    name: file.name,
                    type: file.type,
                    dataUrl: event.target.result
                });
                db.saveFiles(allFiles);
                renderFiles();
                document.getElementById('upload-form').reset();
            };
            reader.readAsDataURL(file);
        };


        // --- Event Listeners ---
        // Navigation
        nav.brand.addEventListener('click', () => showPage('landing-page'));
        nav.dashboard.addEventListener('click', () => showPage('dashboard-page'));
        nav.login.addEventListener('click', () => showPage('auth-page'));
        nav.logout.addEventListener('click', handleLogout);
        document.getElementById('get-started-btn').addEventListener('click', () => showPage('auth-page'));

        // Auth Forms
        document.getElementById('login-form').addEventListener('submit', handleLogin);
        document.getElementById('register-form').addEventListener('submit', handleRegister);
        document.getElementById('show-register-link').addEventListener('click', showRegisterForm);
        document.getElementById('show-login-link').addEventListener('click', showLoginForm);

        // Dashboard Forms
        document.getElementById('note-form').addEventListener('submit', handleAddNote);
        document.getElementById('upload-form').addEventListener('submit', handleAddFile);
        document.getElementById('notes-list').addEventListener('click', handleDeleteNote);


        // --- Initial Load ---
        const init = () => {
            if (currentUser) {
                showPage('dashboard-page');
                renderDashboard();
            } else {
                showPage('landing-page');
            }
        };

        init();
    });
    </script>
</body>
</html>
