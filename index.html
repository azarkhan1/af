<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Cryptocurrency Market</title>
    <script src="https://cdn.jsdelivr.net/npm/lightweight-charts@3.8.0/dist/lightweight-charts.standalone.production.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6c5ce7;
            --secondary: #a29bfe;
            --dark: #1e1e2f;
            --darker: #161622;
            --light: #f5f6fa;
            --success: #00b894;
            --danger: #d63031;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--darker);
            color: var(--light);
            min-height: 100vh;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
        }
        
        .price-up {
            color: var(--success);
        }
        
        .price-down {
            color: var(--danger);
        }
        
        #candlestick-chart {
            height: 500px;
            width: 100%;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .crypto-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        @keyframes pulseGreen {
            0% { background-color: transparent; }
            50% { background-color: rgba(0, 184, 148, 0.2); }
            100% { background-color: transparent; }
        }
        
        @keyframes pulseRed {
            0% { background-color: transparent; }
            50% { background-color: rgba(214, 48, 49, 0.2); }
            100% { background-color: transparent; }
        }
        
        .positive-change {
            animation: pulseGreen 1.5s ease-out;
        }
        
        .negative-change {
            animation: pulseRed 1.5s ease-out;
        }
        
        .timeframe-btn.active {
            background: linear-gradient(to right, #6c5ce7, #0984e3);
            color: white;
        }
        
        .crypto-logo {
            width: 24px;
            height: 24px;
            object-fit: contain;
        }
    </style>
</head>
<body class="antialiased">
    <!-- Navbar -->
    <nav class="glass-card fixed top-0 left-0 right-0 z-50 py-4 px-6 flex justify-between items-center">
        <div class="flex items-center space-x-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-500" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" />
            </svg>
            <span class="text-xl font-bold bg-gradient-to-r from-purple-500 to-blue-500 bg-clip-text text-transparent">CryptoVision</span>
        </div>
        <div class="flex items-center space-x-4">
            <button class="px-4 py-2 rounded-lg bg-gradient-to-r from-purple-600 to-blue-600 text-white font-medium hover:opacity-90 transition-opacity">
                Connect Wallet
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 pt-24 pb-12">
        <!-- Market Overview -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8">
            <div class="glass-card p-6">
                <div class="flex justify-between items-start">
                    <div>
                        <p class="text-gray-400 text-sm">Total Market Cap</p>
                        <h3 class="text-2xl font-bold text-white mt-1" id="market-cap">$1.42T</h3>
                    </div>
                    <div class="text-success flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd" />
                        </svg>
                        <span class="ml-1" id="market-cap-change">2.34%</span>
                    </div>
                </div>
            </div>
            
            <div class="glass-card p-6">
                <div class="flex justify-between items-start">
                    <div>
                        <p class="text-gray-400 text-sm">24h Volume</p>
                        <h3 class="text-2xl font-bold text-white mt-1" id="market-volume">$48.7B</h3>
                    </div>
                    <div class="text-success flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd" />
                        </svg>
                        <span class="ml-1" id="volume-change">12.5%</span>
                    </div>
                </div>
            </div>
            
            <div class="glass-card p-6">
                <div class="flex justify-between items-start">
                    <div>
                        <p class="text-gray-400 text-sm">BTC Dominance</p>
                        <h3 class="text-2xl font-bold text-white mt-1" id="btc-dominance">48.2%</h3>
                    </div>
                    <div class="text-danger flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M12 13a1 1 0 100 2h5a1 1 0 001-1v-5a1 1 0 10-2 0v2.586l-4.293-4.293a1 1 0 00-1.414 0L8 9.586l-4.293-4.293a1 1 0 00-1.414 1.414l5 5a1 1 0 001.414 0L11 9.414 14.586 13H12z" clip-rule="evenodd" />
                        </svg>
                        <span class="ml-1" id="btc-dominance-change">0.8%</span>
                    </div>
                </div>
            </div>
            
            <div class="glass-card p-6">
                <div class="flex justify-between items-start">
                    <div>
                        <p class="text-gray-400 text-sm">Fear & Greed Index</p>
                        <h3 class="text-2xl font-bold text-white mt-1">64</h3>
                    </div>
                    <div class="text-success">
                        <span class="text-sm">Greed</span>
                    </div>
                </div>
                <div class="w-full bg-gray-700 rounded-full h-2 mt-3">
                    <div class="bg-yellow-400 h-2 rounded-full" style="width: 64%"></div>
                </div>
            </div>
        </div>
        
        <!-- Interactive Candlestick Chart -->
        <div class="glass-card p-6 mb-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-white">BTC/USDT</h2>
                <div class="flex space-x-2">
                    <button id="timeframe-1h" class="timeframe-btn px-3 py-1 text-sm rounded-lg bg-gray-700 text-white hover:bg-gray-600">1H</button>
                    <button id="timeframe-4h" class="timeframe-btn px-3 py-1 text-sm rounded-lg bg-gray-700 text-white hover:bg-gray-600">4H</button>
                    <button id="timeframe-1d" class="timeframe-btn px-3 py-1 text-sm rounded-lg bg-purple-600 text-white active">1D</button>
                    <button id="timeframe-1w" class="timeframe-btn px-3 py-1 text-sm rounded-lg bg-gray-700 text-white hover:bg-gray-600">1W</button>
                </div>
            </div>
            <div id="candlestick-chart"></div>
        </div>
        
        <!-- Top Cryptocurrencies -->
        <div class="glass-card p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold text-white">Top Cryptocurrencies</h2>
                <div class="relative">
                    <input type="text" id="search-crypto" placeholder="Search..." class="bg-gray-800 text-white rounded-lg py-2 px-4 pl-10 focus:outline-none focus:ring-2 focus:ring-purple-500 text-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 absolute left-3 top-2.5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                    </svg>
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="text-gray-400 text-left border-b border-gray-700">
                            <th class="pb-3 pl-4">#</th>
                            <th class="pb-3">Name</th>
                            <th class="pb-3 text-right">Price</th>
                            <th class="pb-3 text-right">24h %</th>
                            <th class="pb-3 text-right">Market Cap</th>
                            <th class="pb-3 pr-4 text-right">Last 7 Days</th>
                        </tr>
                    </thead>
                    <tbody id="crypto-table">
                        <!-- Crypto data will be inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div class="flex justify-center mt-6">
                <button id="load-more" class="px-6 py-2 rounded-lg bg-gray-700 text-white font-medium hover:bg-gray-600 transition-colors">
                    Load More
                </button>
            </div>
        </div>
    </main>

    <script>
        // Initialize candlestick chart
        const chartContainer = document.getElementById('candlestick-chart');
        const chart = LightweightCharts.createChart(chartContainer, {
            layout: {
                background: { color: 'transparent' },
                textColor: '#D9D9D9',
            },
            grid: {
                vertLines: { color: 'rgba(255, 255, 255, 0.05)' },
                horzLines: { color: 'rgba(255, 255, 255, 0.05)' },
            },
            crosshair: {
                mode: LightweightCharts.CrosshairMode.Normal,
            },
            rightPriceScale: {
                borderColor: 'rgba(255, 255, 255, 0.1)',
            },
            timeScale: {
                borderColor: 'rgba(255, 255, 255, 0.1)',
            },
        });

        const candlestickSeries = chart.addCandlestickSeries({
            upColor: '#00b894',
            downColor: '#d63031',
            borderDownColor: '#d63031',
            borderUpColor: '#00b894',
            wickDownColor: '#d63031',
            wickUpColor: '#00b894',
        });

        // Crypto logo URLs (fixed to use reliable sources)
        const cryptoLogos = {
            bitcoin: 'https://cryptologos.cc/logos/bitcoin-btc-logo.png',
            ethereum: 'https://cryptologos.cc/logos/ethereum-eth-logo.png',
            binancecoin: 'https://cryptologos.cc/logos/bnb-bnb-logo.png',
            solana: 'https://cryptologos.cc/logos/solana-sol-logo.png',
            ripple: 'https://cryptologos.cc/logos/xrp-xrp-logo.png',
            cardano: 'https://cryptologos.cc/logos/cardano-ada-logo.png',
            dogecoin: 'https://cryptologos.cc/logos/dogecoin-doge-logo.png',
            polkadot: 'https://cryptologos.cc/logos/polkadot-new-dot-logo.png',
            tether: 'https://cryptologos.cc/logos/tether-usdt-logo.png',
            litecoin: 'https://cryptologos.cc/logos/litecoin-ltc-logo.png'
        };

        // Generate initial candlestick data with different timeframes
        function generateCandles(timeframe) {
            const now = new Date();
            const candles = [];
            let previousClose = 50000;
            let minutesPerCandle;
            let candleCount;
            
            switch(timeframe) {
                case '1h':
                    minutesPerCandle = 5; // 12 candles per hour
                    candleCount = 100;
                    break;
                case '4h':
                    minutesPerCandle = 15; // 4 candles per hour
                    candleCount = 100;
                    break;
                case '1d':
                    minutesPerCandle = 60; // 1 candle per hour
                    candleCount = 100;
                    break;
                case '1w':
                    minutesPerCandle = 60 * 24; // 1 candle per day
                    candleCount = 100;
                    break;
                default:
                    minutesPerCandle = 60;
                    candleCount = 100;
            }
            
            for (let i = candleCount; i >= 0; i--) {
                const time = new Date(now);
                if (timeframe === '1w') {
                    time.setDate(time.getDate() - i);
                } else {
                    time.setMinutes(time.getMinutes() - i * minutesPerCandle);
                }
                
                const open = previousClose;
                const close = open * (0.995 + Math.random() * 0.01);
                const high = Math.max(open, close) * (1 + Math.random() * 0.005);
                const low = Math.min(open, close) * (1 - Math.random() * 0.005);
                
                candles.push({
                    time: Math.floor(time.getTime() / 1000),
                    open,
                    high,
                    low,
                    close,
                });
                
                previousClose = close;
            }
            
            return candles;
        }

        // Current timeframe
        let currentTimeframe = '1d';
        let candlestickData = generateCandles(currentTimeframe);

        // Update candlestick data based on timeframe
        function updateCandlestick() {
            const lastCandle = candlestickData[candlestickData.length - 1];
            const now = Math.floor(Date.now() / 1000);
            
            // Determine update frequency based on timeframe
            let updateProbability;
            switch(currentTimeframe) {
                case '1h': updateProbability = 0.8; break;
                case '4h': updateProbability = 0.6; break;
                case '1d': updateProbability = 0.3; break;
                case '1w': updateProbability = 0.1; break;
                default: updateProbability = 0.3;
            }
            
            if (Math.random() < updateProbability) {
                const newCandle = {
                    time: now,
                    open: lastCandle.close,
                    high: lastCandle.close * (1 + Math.random() * 0.002),
                    low: lastCandle.close * (1 - Math.random() * 0.002),
                    close: lastCandle.close * (0.999 + Math.random() * 0.002),
                };
                
                candlestickData.push(newCandle);
                
                // Keep only last 100 candles
                if (candlestickData.length > 100) {
                    candlestickData.shift();
                }
            } else {
                // Update current candle
                const currentCandle = lastCandle;
                const priceChange = currentCandle.close * (Math.random() * 0.001 - 0.0005);
                const newClose = currentCandle.close + priceChange;
                
                currentCandle.close = newClose;
                currentCandle.high = Math.max(currentCandle.high, newClose);
                currentCandle.low = Math.min(currentCandle.low, newClose);
            }
            
            candlestickSeries.setData(candlestickData);
            chart.timeScale().fitContent();
        }

        // Sample cryptocurrency data with more coins
        let cryptocurrencies = [
            { id: 'bitcoin', symbol: 'btc', name: 'Bitcoin', price: 50234.56, change24h: 1.23, marketCap: 950000000000, sparkline: generateSparklineData(50000) },
            { id: 'ethereum', symbol: 'eth', name: 'Ethereum', price: 3245.67, change24h: -0.45, marketCap: 380000000000, sparkline: generateSparklineData(3200) },
            { id: 'binancecoin', symbol: 'bnb', name: 'BNB', price: 412.34, change24h: 2.12, marketCap: 68000000000, sparkline: generateSparklineData(400) },
            { id: 'solana', symbol: 'sol', name: 'Solana', price: 112.45, change24h: 5.67, marketCap: 45000000000, sparkline: generateSparklineData(110) },
            { id: 'ripple', symbol: 'xrp', name: 'XRP', price: 0.5234, change24h: -1.23, marketCap: 28000000000, sparkline: generateSparklineData(0.52) },
            { id: 'cardano', symbol: 'ada', name: 'Cardano', price: 0.4567, change24h: 0.89, marketCap: 16000000000, sparkline: generateSparklineData(0.45) },
            { id: 'dogecoin', symbol: 'doge', name: 'Dogecoin', price: 0.1234, change24h: -3.45, marketCap: 17000000000, sparkline: generateSparklineData(0.12) },
            { id: 'polkadot', symbol: 'dot', name: 'Polkadot', price: 7.89, change24h: 1.23, marketCap: 9000000000, sparkline: generateSparklineData(7.8) },
            { id: 'tether', symbol: 'usdt', name: 'Tether', price: 1.00, change24h: 0.01, marketCap: 80000000000, sparkline: generateSparklineData(1) },
            { id: 'litecoin', symbol: 'ltc', name: 'Litecoin', price: 70.23, change24h: -0.78, marketCap: 5000000000, sparkline: generateSparklineData(70) }
        ];

        // More cryptocurrencies to load
        const moreCryptocurrencies = [
            { id: 'chainlink', symbol: 'link', name: 'Chainlink', price: 15.67, change24h: 2.34, marketCap: 7000000000, sparkline: generateSparklineData(15) },
            { id: 'polygon', symbol: 'matic', name: 'Polygon', price: 0.78, change24h: -1.23, marketCap: 6000000000, sparkline: generateSparklineData(0.78) },
            { id: 'avalanche', symbol: 'avax', name: 'Avalanche', price: 30.45, change24h: 3.45, marketCap: 10000000000, sparkline: generateSparklineData(30) },
            { id: 'uniswap', symbol: 'uni', name: 'Uniswap', price: 6.78, change24h: -0.56, marketCap: 4500000000, sparkline: generateSparklineData(6.8) },
            { id: 'bitcoin-cash', symbol: 'bch', name: 'Bitcoin Cash', price: 250.67, change24h: 1.23, marketCap: 4000000000, sparkline: generateSparklineData(250) }
        ];

        // Generate sparkline data
        function generateSparklineData(basePrice) {
            const data = [];
            for (let i = 0; i < 7; i++) {
                data.push(basePrice * (0.95 + Math.random() * 0.1));
            }
            return data;
        }

        // Render cryptocurrency table
        function renderCryptoTable(data = cryptocurrencies) {
            const tableBody = document.getElementById('crypto-table');
            tableBody.innerHTML = '';
            
            data.forEach((crypto, index) => {
                const changeClass = crypto.change24h >= 0 ? 'price-up' : 'price-down';
                const changeIcon = crypto.change24h >= 0 ? 
                    '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd" /></svg>' :
                    '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12 13a1 1 0 100 2h5a1 1 0 001-1v-5a1 1 0 10-2 0v2.586l-4.293-4.293a1 1 0 00-1.414 0L8 9.586l-4.293-4.293a1 1 0 00-1.414 1.414l5 5a1 1 0 001.414 0L11 9.414 14.586 13H12z" clip-rule="evenodd" /></svg>';
                
                const row = document.createElement('tr');
                row.className = 'crypto-card hover:bg-gray-800/50 transition-colors';
                row.innerHTML = `
                    <td class="py-4 pl-4 text-gray-400">${index + 1}</td>
                    <td class="py-4">
                        <div class="flex items-center">
                            <img src="${cryptoLogos[crypto.id] || 'https://cryptologos.cc/logos/bitcoin-btc-logo.png'}" alt="${crypto.name}" class="crypto-logo mr-3">
                            <span class="font-medium text-white">${crypto.name}</span>
                            <span class="text-gray-400 text-sm ml-2">${crypto.symbol.toUpperCase()}</span>
                        </div>
                    </td>
                    <td class="py-4 text-right font-medium text-white" id="price-${crypto.id}">
                        $${crypto.price.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: crypto.price < 1 ? 6 : 2 })}
                    </td>
                    <td class="py-4 text-right ${changeClass}">
                        ${changeIcon}${Math.abs(crypto.change24h).toFixed(2)}%
                    </td>
                    <td class="py-4 text-right text-white">
                        $${(crypto.marketCap / 1000000000).toFixed(2)}B
                    </td>
                    <td class="py-4 pr-4">
                        <div class="h-10 w-32 ml-auto">
                            <canvas id="sparkline-${crypto.id}" width="128" height="40"></canvas>
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
                
                // Render sparkline chart
                renderSparklineChart(`sparkline-${crypto.id}`, crypto.sparkline, crypto.change24h >= 0);
            });
        }

        // Render sparkline chart
        function renderSparklineChart(canvasId, data, isPositive) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Create gradient
            const gradient = ctx.createLinearGradient(0, 0, 0, 40);
            gradient.addColorStop(0, isPositive ? 'rgba(0, 184, 148, 0.3)' : 'rgba(214, 48, 49, 0.3)');
            gradient.addColorStop(1, 'transparent');
            
            // Find min and max for scaling
            const min = Math.min(...data);
            const max = Math.max(...data);
            const range = max - min;
            
            // Draw sparkline
            ctx.beginPath();
            ctx.moveTo(0, 40 - ((data[0] - min) / range * 40));
            
            for (let i = 1; i < data.length; i++) {
                ctx.lineTo(i * (128 / (data.length - 1)), 40 - ((data[i] - min) / range * 40));
            }
            
            ctx.strokeStyle = isPositive ? '#00b894' : '#d63031';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Fill area under sparkline
            ctx.lineTo(128, 40);
            ctx.lineTo(0, 40);
            ctx.closePath();
            ctx.fillStyle = gradient;
            ctx.fill();
        }

        // Update cryptocurrency prices randomly
        function updateCryptoPrices() {
            cryptocurrencies.forEach(crypto => {
                if (crypto.symbol !== 'usdt') { // Skip stablecoins
                    // Store previous price for animation
                    const prevPrice = crypto.price;
                    
                    // Generate new price with some randomness
                    const changeFactor = 1 + (Math.random() * 0.002 - 0.001);
                    crypto.price *= changeFactor;
                    
                    // Update 24h change
                    crypto.change24h = (Math.random() * 4 - 2);
                    
                    // Update sparkline data
                    crypto.sparkline.shift();
                    crypto.sparkline.push(crypto.sparkline[crypto.sparkline.length - 1] * (0.99 + Math.random() * 0.02));
                    
                    // Update market cap based on new price
                    crypto.marketCap = crypto.marketCap * changeFactor;
                    
                    // Update DOM if this crypto is currently displayed
                    const priceCell = document.getElementById(`price-${crypto.id}`);
                    if (priceCell) {
                        // Add animation class if price changed significantly
                        if (Math.abs(crypto.price - prevPrice) > prevPrice * 0.0005) {
                            priceCell.classList.remove('positive-change', 'negative-change');
                            void priceCell.offsetWidth; // Trigger reflow
                            priceCell.classList.add(crypto.price > prevPrice ? 'positive-change' : 'negative-change');
                        }
                        
                        priceCell.textContent = `$${crypto.price.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: crypto.price < 1 ? 6 : 2 })}`;
                        
                        // Update 24h change cell
                        const changeCell = priceCell.parentElement.querySelector('.price-up, .price-down');
                        if (changeCell) {
                            changeCell.className = crypto.change24h >= 0 ? 'price-up' : 'price-down';
                            changeCell.innerHTML = crypto.change24h >= 0 ? 
                                '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd" /></svg>' + 
                                Math.abs(crypto.change24h).toFixed(2) + '%' :
                                '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12 13a1 1 0 100 2h5a1 1 0 001-1v-5a1 1 0 10-2 0v2.586l-4.293-4.293a1 1 0 00-1.414 0L8 9.586l-4.293-4.293a1 1 0 00-1.414 1.414l5 5a1 1 0 001.414 0L11 9.414 14.586 13H12z" clip-rule="evenodd" /></svg>' + 
                                Math.abs(crypto.change24h).toFixed(2) + '%';
                        }
                    }
                }
            });
            
            // Update market data
            updateMarketData();
            
            // Re-render sparklines
            cryptocurrencies.forEach(crypto => {
                const canvas = document.getElementById(`sparkline-${crypto.id}`);
                if (canvas) {
                    renderSparklineChart(`sparkline-${crypto.id}`, crypto.sparkline, crypto.change24h >= 0);
                }
            });
        }

        // Update market data
        function updateMarketData() {
            const totalMarketCap = cryptocurrencies.reduce((sum, crypto) => sum + crypto.marketCap, 0);
            const marketCapChange = (Math.random() * 2 - 1).toFixed(2);
            document.getElementById('market-cap').textContent = `$${(totalMarketCap / 1000000000000).toFixed(2)}T`;
            document.getElementById('market-cap-change').textContent = `${marketCapChange > 0 ? '+' : ''}${marketCapChange}%`;
            document.getElementById('market-cap-change').className = marketCapChange >= 0 ? 'text-success flex items-center' : 'text-danger flex items-center';
            
            const totalVolume = totalMarketCap * (0.03 + Math.random() * 0.02);
            const volumeChange = (Math.random() * 5).toFixed(1);
            document.getElementById('market-volume').textContent = `$${(totalVolume / 1000000000).toFixed(1)}B`;
            document.getElementById('volume-change').textContent = `+${volumeChange}%`;
            
            const btc = cryptocurrencies.find(c => c.symbol === 'btc');
            const btcDominance = (btc.marketCap / totalMarketCap * 100).toFixed(1);
            const btcDominanceChange = (Math.random() * 1 - 0.5).toFixed(1);
            document.getElementById('btc-dominance').textContent = `${btcDominance}%`;
            document.getElementById('btc-dominance-change').textContent = `${btcDominanceChange > 0 ? '+' : ''}${btcDominanceChange}%`;
            document.getElementById('btc-dominance-change').className = btcDominanceChange >= 0 ? 'text-success flex items-center' : 'text-danger flex items-center';
        }

        // Change timeframe
        function changeTimeframe(timeframe) {
            currentTimeframe = timeframe;
            candlestickData = generateCandles(timeframe);
            candlestickSeries.setData(candlestickData);
            chart.timeScale().fitContent();
            
            // Update active button
            document.querySelectorAll('.timeframe-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.classList.add('bg-gray-700');
            });
            document.getElementById(`timeframe-${timeframe}`).classList.add('active');
            document.getElementById(`timeframe-${timeframe}`).classList.remove('bg-gray-700');
        }

        // Search functionality
        function searchCryptocurrencies() {
            const searchTerm = document.getElementById('search-crypto').value.toLowerCase();
            const filtered = cryptocurrencies.filter(crypto => 
                crypto.name.toLowerCase().includes(searchTerm) || 
                crypto.symbol.toLowerCase().includes(searchTerm)
            );
            renderCryptoTable(filtered);
        }

        // Load more cryptocurrencies
        function loadMoreCryptos() {
            if (moreCryptocurrencies.length > 0) {
                const toAdd = moreCryptocurrencies.splice(0, 5);
                cryptocurrencies = [...cryptocurrencies, ...toAdd];
                renderCryptoTable();
                
                if (moreCryptocurrencies.length === 0) {
                    document.getElementById('load-more').style.display = 'none';
                }
            }
        }

        // Initialize
        candlestickSeries.setData(candlestickData);
        chart.timeScale().fitContent();
        renderCryptoTable();

        // Event listeners
        document.getElementById('timeframe-1h').addEventListener('click', () => changeTimeframe('1h'));
        document.getElementById('timeframe-4h').addEventListener('click', () => changeTimeframe('4h'));
        document.getElementById('timeframe-1d').addEventListener('click', () => changeTimeframe('1d'));
        document.getElementById('timeframe-1w').addEventListener('click', () => changeTimeframe('1w'));
        document.getElementById('search-crypto').addEventListener('input', searchCryptocurrencies);
        document.getElementById('load-more').addEventListener('click', loadMoreCryptos);

        // Start real-time updates
        setInterval(updateCandlestick, 1000);
        setInterval(updateCryptoPrices, 3000);
        
    </script>
    <style>
  .loader-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #161622;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    transition: opacity 0.5s ease;
  }
  
  .loader-logo {
    width: 80px;
    height: 80px;
    margin-bottom: 20px;
    animation: pulse 1.5s infinite ease-in-out;
  }
  
  .loader-spinner {
    width: 50px;
    height: 50px;
    border: 5px solid rgba(255,255,255,0.1);
    border-radius: 50%;
    border-top-color: #6c5ce7;
    animation: spin 1s linear infinite;
  }
  
  .loader-text {
    margin-top: 20px;
    color: #f5f6fa;
    font-size: 18px;
    font-family: 'Inter', sans-serif;
  }
  
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  
  @keyframes pulse {
    0% { transform: scale(0.95); opacity: 0.8; }
    50% { transform: scale(1.05); opacity: 1; }
    100% { transform: scale(0.95); opacity: 0.8; }
  }
</style>

<div class="loader-container" id="page-loader">
  <div class="loader-logo">
    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z" 
            fill="#6c5ce7"/>
    </svg>
  </div>
  <div class="loader-spinner"></div>
  <div class="loader-text">در حال بارگذاری...</div>
</div>

<script>
  // Hide loader after 2 seconds
  setTimeout(function() {
    document.getElementById('page-loader').style.opacity = '0';
    setTimeout(function() {
      document.getElementById('page-loader').style.display = 'none';
    }, 500);
  }, 2000);
</script>
<div class="glass-card p-6 mt-8">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-xl font-bold text-white">Gold & Precious Metals Prices</h2>
        <div class="flex items-center space-x-2">
            <button id="gold-live" class="px-3 py-1 text-sm rounded-lg bg-purple-600 text-white">Live Prices</button>
            <button id="gold-historical" class="px-3 py-1 text-sm rounded-lg bg-gray-700 text-white hover:bg-gray-600">Historical Data</button>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <!-- 18K Gold -->
        <div class="bg-gray-800 rounded-lg p-4">
            <div class="flex justify-between items-center">
                <div>
                    <p class="text-gray-300 text-sm">18K Gold (per ounce)</p>
                    <h3 class="text-xl font-bold text-white mt-1" id="gold-18k">$1,412.50</h3>
                </div>
                <div class="text-success flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd" />
                    </svg>
                    <span class="ml-1" id="gold-18k-change">1.2%</span>
                </div>
            </div>
            <div class="mt-3 h-20">
                <canvas id="gold-18k-chart"></canvas>
            </div>
        </div>

        <!-- 24K Gold -->
        <div class="bg-gray-800 rounded-lg p-4">
            <div class="flex justify-between items-center">
                <div>
                    <p class="text-gray-300 text-sm">24K Gold (per ounce)</p>
                    <h3 class="text-xl font-bold text-white mt-1" id="gold-24k">$1,890.75</h3>
                </div>
                <div class="text-danger flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12 13a1 1 0 100 2h5a1 1 0 001-1v-5a1 1 0 10-2 0v2.586l-4.293-4.293a1 1 0 00-1.414 0L8 9.586l-4.293-4.293a1 1 0 00-1.414 1.414l5 5a1 1 0 001.414 0L11 9.414 14.586 13H12z" clip-rule="evenodd" />
                    </svg>
                    <span class="ml-1" id="gold-24k-change">0.8%</span>
                </div>
            </div>
            <div class="mt-3 h-20">
                <canvas id="gold-24k-chart"></canvas>
            </div>
        </div>

        <!-- Gold Coin -->
        <div class="bg-gray-800 rounded-lg p-4">
            <div class="flex justify-between items-center">
                <div>
                    <p class="text-gray-300 text-sm">Gold Coin (1oz)</p>
                    <h3 class="text-xl font-bold text-white mt-1" id="gold-coin">$1,925.40</h3>
                </div>
                <div class="text-success flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd" />
                    </svg>
                    <span class="ml-1" id="gold-coin-change">2.1%</span>
                </div>
            </div>
            <div class="mt-3 h-20">
                <canvas id="gold-coin-chart"></canvas>
            </div>
        </div>

        <!-- Silver -->
        <div class="bg-gray-800 rounded-lg p-4">
            <div class="flex justify-between items-center">
                <div>
                    <p class="text-gray-300 text-sm">Silver (per ounce)</p>
                    <h3 class="text-xl font-bold text-white mt-1" id="silver-ounce">$28.45</h3>
                </div>
                <div class="text-success flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd" />
                    </svg>
                    <span class="ml-1" id="silver-ounce-change">1.5%</span>
                </div>
            </div>
            <div class="mt-3 h-20">
                <canvas id="silver-ounce-chart"></canvas>
            </div>
        </div>
    </div>

    <!-- Other Precious Metals Table -->
    <div class="mt-6 overflow-x-auto">
        <table class="w-full">
            <thead>
                <tr class="text-gray-400 text-left border-b border-gray-700">
                    <th class="pb-3">Precious Metal</th>
                    <th class="pb-3 text-right">Price (USD)</th>
                    <th class="pb-3 text-right">24h Change</th>
                    <th class="pb-3 pr-4 text-right">7-Day Trend</th>
                </tr>
            </thead>
            <tbody>
                <tr class="border-b border-gray-700 hover:bg-gray-800/50">
                    <td class="py-3">
                        <div class="flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-400 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 100-2 1 1 0 000 2zm7-1a1 1 0 11-2 0 1 1 0 012 0zm-.464 5.535a1 1 0 10-1.415-1.414 3 3 0 01-4.242 0 1 1 0 00-1.415 1.414 5 5 0 007.072 0z" clip-rule="evenodd" />
                            </svg>
                            <span>Gold Bullion</span>
                        </div>
                    </td>
                    <td class="py-3 text-right text-white">$1,850.20</td>
                    <td class="py-3 text-right text-success">+0.9%</td>
                    <td class="py-3 pr-4">
                        <div class="h-10 w-32 ml-auto">
                            <canvas id="gold-bullion-chart"></canvas>
                        </div>
                    </td>
                </tr>
                <tr class="border-b border-gray-700 hover:bg-gray-800/50">
                    <td class="py-3">
                        <div class="flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-300 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 100-2 1 1 0 000 2zm7-1a1 1 0 11-2 0 1 1 0 012 0zm-.464 5.535a1 1 0 10-1.415-1.414 3 3 0 01-4.242 0 1 1 0 00-1.415 1.414 5 5 0 007.072 0z" clip-rule="evenodd" />
                            </svg>
                            <span>Platinum</span>
                        </div>
                    </td>
                    <td class="py-3 text-right text-white">$1,025.60</td>
                    <td class="py-3 text-right text-danger">-0.5%</td>
                    <td class="py-3 pr-4">
                        <div class="h-10 w-32 ml-auto">
                            <canvas id="platinum-chart"></canvas>
                        </div>
                    </td>
                </tr>
                <tr class="border-b border-gray-700 hover:bg-gray-800/50">
                    <td class="py-3">
                        <div class="flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 100-2 1 1 0 000 2zm7-1a1 1 0 11-2 0 1 1 0 012 0zm-.464 5.535a1 1 0 10-1.415-1.414 3 3 0 01-4.242 0 1 1 0 00-1.415 1.414 5 5 0 007.072 0z" clip-rule="evenodd" />
                            </svg>
                            <span>Palladium</span>
                        </div>
                    </td>
                    <td class="py-3 text-right text-white">$1,456.80</td>
                    <td class="py-3 text-right text-success">+1.8%</td>
                    <td class="py-3 pr-4">
                        <div class="h-10 w-32 ml-auto">
                            <canvas id="palladium-chart"></canvas>
                        </div>
                    </td>
                </tr>
                <tr class="hover:bg-gray-800/50">
                    <td class="py-3">
                        <div class="flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-yellow-300 mr-2" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 100-2 1 1 0 000 2zm7-1a1 1 0 11-2 0 1 1 0 012 0zm-.464 5.535a1 1 0 10-1.415-1.414 3 3 0 01-4.242 0 1 1 0 00-1.415 1.414 5 5 0 007.072 0z" clip-rule="evenodd" />
                            </svg>
                            <span>Rhodium</span>
                        </div>
                    </td>
                    <td class="py-3 text-right text-white">$4,850.00</td>
                    <td class="py-3 text-right text-success">+2.3%</td>
                    <td class="py-3 pr-4">
                        <div class="h-10 w-32 ml-auto">
                            <canvas id="rhodium-chart"></canvas>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<script>
    // Initialize gold price charts
    function initGoldCharts() {
        const chartConfig = {
            type: 'line',
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { x: { display: false }, y: { display: false } },
                elements: { point: { radius: 0 } }
            }
        };

        // Gold 18k chart
        new Chart(
            document.getElementById('gold-18k-chart'),
            {
                ...chartConfig,
                data: {
                    labels: Array(7).fill(''),
                    datasets: [{
                        data: [1400, 1405, 1410, 1412.5, 1415, 1410, 1412.5],
                        borderColor: '#00b894',
                        borderWidth: 2,
                        fill: true,
                        backgroundColor: 'rgba(0, 184, 148, 0.1)',
                        tension: 0.4
                    }]
                }
            }
        );

        // Gold 24k chart
        new Chart(
            document.getElementById('gold-24k-chart'),
            {
                ...chartConfig,
                data: {
                    labels: Array(7).fill(''),
                    datasets: [{
                        data: [1875, 1880, 1885, 1890.75, 1895, 1892, 1890.75],
                        borderColor: '#d63031',
                        borderWidth: 2,
                        fill: true,
                        backgroundColor: 'rgba(214, 48, 49, 0.1)',
                        tension: 0.4
                    }]
                }
            }
        );

        // Initialize other charts...
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', function() {
        setTimeout(initGoldCharts, 2000);
    });
</script>
</body>
</html>
